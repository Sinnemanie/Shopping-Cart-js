<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online-Shop</title>
    <script type="text/javascript" src="./src/warenkorb.js"></script>
    <script type="text/javascript" src="./src/artikel.js"></script>

    <link rel="stylesheet" href="./node_modules/bootswatch/dist/quartz/bootstrap.css">
    <!-- <script src="./node_modules/jquery/dist/jquery.slim.min.js" type="text/javascript"></script> -->
    <script src="./node_modules/jquery/dist/jquery.min.js" type="text/javascript"></script>
    <script src="./node_modules/holderjs/holder.min.js" type="text/javascript"></script>

</head>

<body>
    <nav class="navbar navbar-light bg-primary">
        <div class="container">
            <a class="navbar-brand" href="#">
                <img src="holder.js/25x25?text=L&amp;random=true&amp;nowrap=true&amp;auto=yes" width="30" height="24"
                    class="d-inline-block align-text-top" alt="Logo">
                DotSource Shop
            </a>
            <span class="navbar-text">
                Shopping Cart
            </span>
        </div>
    </nav>

    <div class="container mt-3">

        <div class="row">
            <div class="col-md-6">
                <div>
                    <div id="products" class="row">
                    </div>
                </div>

            </div>
            <div class="col-md-6">
                <div class="card">

                    <div class="card-header text-end">
                        <div>Warenkorb <span id="count-cart" class="badge bg-info">X</span></div>
                    </div>
                    <div class="card-body">
                        <ul id="show-cart" class="list-group">
                            <!-- <li> -->
                            <!-- dynamic content -->
                            <!-- </li> -->
                        </ul>
                        <div class="h6 mt-3 text-end">Total Cart: <span id="total-cart"></span> EUR</div>
                        <div class="input-group">
                            <input id="rabattEingabe" class="form-control form-control-sm bg-dark" value="0" type="number" onchange="alert('test1')" />
                            <div class="mt-1 mt-1 text-end">(Discount %: <span id="discount-cart"></span> EUR)</div>
                            <div class="mt-0 mt-1 text-end">Voucher: <span id="voucher-cart"></span> EUR</div>
                        </div>
                    </div>
                    <div class="card-footer">
                        <div class="row">
                            <div class="col text-start position-relative">
                                <button type="button" id="clear-cart" class="btn btn-sm btn-secondary  position-absolute top-50 start-0 translate-middle-y">Warenkorb leeren</button>
                                
                            </div>
                            <div class="col text-end">
                                <button type="submit" onclick="alert('Hier endet die Show! ;)')" id="clear-cart" class="btn btn-success">Warenkorb leeren</button>

                            </div>
                            
                        </div>
                    </div>

                </div>

            </div>

        </div>
    </div>
    <script src="js/shoppingCart.js"></script>
    <script src="js/cart_functions.js"></script>

    <script>

        $(".btn-close").on("click", function () {
            $(this).parent(".alert").addClass("d-none");
        })


        let contentHTML = "";

        for (var i = 0; i < kategorie.length; i++) {
            if (kategorie[i].name != "Gutscheine" && kategorie[i].name != "Rabattaktionen") {
                for (var j = 0; j < kategorie[i].artikel.length; j++) {
                    var a = kategorie[i].artikel[j];

                    contentHTML += `
                        <div class="col-12 col-sm-12 col-lg-6">
                        <div class="card mb-2">
                            <img src="holder.js/306x306?random=true&amp;nowrap=true&amp;auto=yes" class="card-img-top img-fluid" alt="${a.name}">
                            <div class="card-body">
                                <h5 class="card-title text-truncate">${a.name}</h5>
                                <p class="card-text">
                                    ${kategorie[i].name}<br />
                                    ${a.kurz}&euro;<br />
                                </p>
                                <div class="h4 text-info text-end">${a.preis}&euro;</div>
                                <div class="d-grid gap-2">
                                    <button class="add-to-cart btn btn-primary stretched-link" data-name="${a.name}" data-price="${a.preis}">
                                        kaufen
                                    </button>
                                </div>
                            </div>
                        </div>
                        </div>
                        `
                }
            }
        }



        $(document).ready(function () {
            $("#products").html(contentHTML);
        })
    </script>
    <script>
        // $(document).ready(function () {
        //     $("#products").html(contentHTML);
        // })
        $(document).ready(function () {
            // $("#products").html(contentHTML);
            $(".add-to-cart").bind("click", function (event) {
                event.preventDefault();
                var name = $(this).attr("data-name");
                var price = Number($(this).attr("data-price"));

                console.log(name + "" + price)

                shoppingCart.addItemToCart(name, price, 1);
                displayCart();
            });
        })


        $("#clear-cart").click(function (event) {
            shoppingCart.clearCart();
            displayCart();
        });


        $("#show-cart").on("click", ".delete-item", function (event) {
            var name = $(this).attr("data-name");
            shoppingCart.removeItemFromCartAll(name);
            displayCart();
        });

        $("#show-cart").on("click", ".subtract-item", function (event) {
            var name = $(this).attr("data-name");
            shoppingCart.removeItemFromCart(name);
            displayCart();
        });

        $("#show-cart").on("click", ".plus-item", function (event) {
            var name = $(this).attr("data-name");
            shoppingCart.addItemToCart(name, 0, 1);
            displayCart();
        });

        $("#show-cart").on("change", ".item-count", function (event) {
            var name = $(this).attr("data-name");
            var count = Number($(this).val());
            shoppingCart.setCountForItem(name, count);
            displayCart();
        });


        displayCart();

    </script>
</body>

</html>